## 绪论
### 误差与有效数字
#### 误差和误差限
**绝对误差**（简称**误差**）：
	$e = x^{*} - x$，其中 $x^{*}$  是精确值  $x$  的一个近似值。
**误差限**：
	$|e| = |x^{*} - x| \leqslant \epsilon$，正数 $\epsilon$ 称作误差限。
**相对误差**：
	$e_{r} = \frac{e}{x^{*}} = \frac{x^{*} - x}{x^{*}}$ 或 $e_{r} = \frac{e}{x} = \frac{x^{*} - x}{x}$ 为相对误差。
**相对误差限**：
	$e_{r} = \left|\frac{e}{x^{*}}\right| \leqslant \epsilon_{r}$，正数 $\epsilon_{r}$ 称作相对误差限。
误差类型：模型误差、截断误差、舍入误差、观测误差。


#### 有效位数
**定义**：
	当  $x$  的误差限为某一位的半个单位, 则这一位到第一个非零位的位数称为  $x$  的有效位数。
例子：
	对于 $\pi$ ：
	$3.141$ 为三位有效位数；
	$3.1415$ 为四位有效位数；
	$3.14159$ 为六位有效位数。



## 插值
**插值**定义：
	$f(x)$  为定义在区间  $[a,b]$  上的函数， $\{x_{0},x_{1},\dots ,x_{n}\}$ 为 $[a,b]$ 上$n + 1$ 个**互异**点。若有函数 $\phi (x)$，满足 
	$$\phi (x_{i}) = f(x_{i}),\quad i =  0,1,\dots ,n$$
	则称 $\phi (x)$ 为 $f(x)$ 关于节点 $x_{i}$ 的**插值函数**。称点 $x_{i}$ 为**插值节点**；称 $\{(x_{i},f(x_{i})),i = 0,1,\dots ,n\}$ 为**插值型值点**，简称型值点或插值点， $f(x)$ 称为被插函数。


### 拉格朗日 Lagrange 插值
#### 线性插值
即给定两个插值点，过两点作一条直线，这条直线就是过这两点的**一次多项式插值函数**，简称线性插值。

若用两点式表示这条直线，则有

$$
L_{1}(x) = \frac{x - x_{1}}{x_{0} - x_{1}} f(x_{0}) + \frac{x - x_{0}}{x_{1} - x_{0}} f(x_{1})
$$

称这种形式为**拉格朗日插值多项式**，$l_{0}(x) = \frac{x - x_{1}}{x_{0} - x_{1}}$，$l_{1}(x) = \frac{x - x_{0}}{x_{1} - x_{0}}$，称 $l_{0}(x), l_{1}(x)$ 为**插值基函数**。


#### 抛物插值
即给定三个插值点，过三点作一条抛物线，这条抛物线就是过这三点的二次插值。
$$
\begin{array}{c}{{L_{2}(x)=\frac{(x-x_{1})(x-x_{2})}{(x_{0}-x_{1})(x_{0}-x_{2})}f(x_{0})+\frac{(x-x_{0})(x-x_{2})}{(x_{1}-x_{0})(x_{1}-x_{2})}f(x_{1})}}\\ {{+\frac{(x-x_{0})(x-x_{1})}{(x_{2}-x_{0})(x_{2}-x_{1})}f(x_{2})}}\end{array} 
$$

#### 拉格朗日插值多项式
记
$$\omega_{n+1}(x)=(x-x_0)(x-x_1)\dots(x-x_n)$$
$$
\omega'_{n+1}(x_k)=(x_k-x_0)\dots(x_k-x_{k-1})(x_k-x_{k+1})\dots(x_k-x_n)
$$
$n+1$ 个插值点构造 $n$ 次代数多项式。
$$
l_{i}(x) = \frac{(x - x_{0})\cdots(x - x_{i - 1})(x - x_{i + 1})\cdots(x - x_{n})}{(x_{i} - x_{0})\cdots(x_{i} - x_{i - 1})(x_{i} - x_{i + 1})\cdots(x_{i} - x_{n})} = \prod_{0\leqslant j\leqslant n\atop j\neq i}\frac{x - x_{j}}{x_{i} - x_{j}}
$$
$$
L_{n}(x) = \sum_{i = 0}^{n}l_{i}(x)f(x_{i})
$$
#### 插值余项（截断误差）
$$
R(x)=f(x)-p(x) = \frac{f^{(n + 1)}(\xi)}{(n + 1)!} (x - x_{0})(x - x_{1})\dots (x - x_{n}), \quad \xi \in [a,b]
$$

若  $\left|f^{(n + 1)}(x)\right| \leqslant M, x \in [a,b]$ , 则  $R_{n}\left(x\right)$  可表示为
$$
|R_{n}\left(x\right)| \leqslant \frac{M}{(n + 1)!} \prod_{i = 0}^{n}\left|x - x_{i}\right|
$$

### 具有承袭性的插值公式
#### 牛顿插值多项式
线性插值公式可以写成如下形式：
$$
p_1(x)=p_0(x)+c_1(x-x_0),\quad c_1=\frac{f(x_1)-f(x_0)}{x_1-x_0}
$$
抛物插值公式可以写成如下形式：
$$
p_2(x)=p_1(x)+c_2(x-x_0)(x-x_1),\quad c_2=\frac{\frac{f(x_2)-f(x_1)}{x_2-x_0}-\frac{f(x_1)-f(x_0)}{x_1-x_0}}{x_2-x_1}
$$


设任何一个不高于n次的多项式，可以表示成函数
$$1, x - x_0, (x - x_0)(x - x_1), \cdots, (x - x_0)(x - x_1)\cdots(x - x_{n-1})$$
的线性组合，也就是说，可以把满足插值条件
$$p(x_i) = y_i \quad (i=0, 1, \cdots, n)$$
的 $n$ 次插值多项式，写成如下形式
$$
a_0 + a_1(x - x_0) + \cdots + a_n(x - x_0)(x - x_1)\cdots(x - x_{n-1})
$$
其中 $a_k(k=0, 1, 2, \cdots, n)$为待定系数，这种形式的插值多项式称为Newton插值多项式。我们把它记为 $N_n(x)$ 即
$$
N_n(x)=a_0 + a_1(x - x_0) + \cdots + a_n(x - x_0)(x - x_1)\cdots(x - x_{n-1})
$$

#### 差商（均差）性质
> 称函数值的差  $f(x_{1}) - f(x_{0})$  与自变量的差  $x_{1} - x_{0}$  之商比值（即函数在 $(x_0,x_1)$ 上的平均变化率）为  $f(x)$  关于点  $\{x_{0},x_{1}\}$  的一阶差商,记为  $f[x_{0},x_{1}]$
$$
f\left[x_{0},x_{1}\right] = \frac{f(x_{1}) - f(x_{0})}{x_{1} - x_{0}}
$$> 而称
$$
f\left[x_{0},x_{1},x_{2}\right] = \frac{f\left[x_{1},x_{2}\right] - f\left[x_{0},x_{1}\right]}{x_{2} - x_{0}}
$$> 为  $f(x)$  关于点  $x_{0},x_{1},x_{2}$  的二阶差商

由上得出 $N_n(x)$ 的各项系数恰好是各阶差商值：
$$
a_n=f[x_0,x_1,\dots,x_n]
$$
$$
N_n(x)=a_0+a_1(x-x_0)+\dots+a_n(x-x_0)(x-x_1)\dots(x-x_{n-1})
$$
$$
R_n(x)=f[x,x_0,x_1,\dots,x_n]\prod^n_{i=0}(x-x_i)
$$
#### 艾米尔特（Hermite）插值
将牛顿插值中的 $a_n=f[x_0,x_1,\dots,x_n]$ 替换成 $\frac{1}{n!}f^{(n)}(x_0)$，其他不变。

例题：给定  $f(-1) = 0,f(1) = 4,f^{\prime}(-1) = 2,f^{\prime}(1) = 0,$  构造Hermite插值多项式。
<table><tr><td>zi</td><td>f(zi)</td><td>f(zi-1,zi)</td><td>f(zi-2,zi-1,zi)</td><td></td></tr><tr><td>-1</td><td>0</td><td></td><td></td><td></td></tr><tr><td>-1</td><td>0</td><td>2</td><td></td><td></td></tr><tr><td>1</td><td>4</td><td>2</td><td>0</td><td></td></tr><tr><td>1</td><td>4</td><td>0</td><td>-1</td><td>-0.5</td></tr></table>
然后得到 $H_{3}(x) = 2(x + 1) - 0.5(x + 1)^{2}(x - 1)$。

更一般的：
给定  $\{x_{0},f(x_{0}),f^{\prime}(x)\} ,\{x_{1},f(x_{1}),f^{\prime}(x_{1})\} ,$  记  $f^{\prime}(x_{0}) = m_{0},f^{\prime}(x_{1})$ $= m_{1}$，得到下列至多3次的Hermite插值多项式
<table><tr><td>xi</td><td>zi</td><td>f(zi)</td><td>f(zi-1,zi)</td><td>f(zi-2,zi-1,zi)</td><td></td></tr><tr><td>x0</td><td>z0</td><td>f(x0)</td><td></td><td></td><td></td></tr><tr><td>x0</td><td>z1</td><td>f(x0)</td><td>m0</td><td></td><td></td></tr><tr><td>x1</td><td>z2</td><td>f(x1)</td><td>f[x0,x1]</td><td>(f[x0,x1] - m0)/(x1 - x0)</td><td></td></tr><tr><td>x1</td><td>z3</td><td>f(x1)</td><td>m1</td><td>(m1 - f[x0,x1]) / (x1 - x0)</td><td>...</td></tr></table>
$$
\begin{array}{c}{{H_{3}(x)=y_{0}+m_{0}(x-x_{0})+\frac{f[x_{0},x_{1}]-m_{0}}{x_{1}-x_{0}}(x-x_{0})^{2}}}\\ {{+\frac{m_{1}-2f[x_{0},x_{1}]+m_{0}}{x_{1}-x_{0}}(x-x_{0})^{2}(x-x_{1})}}\end{array}
$$

### 三次样条函数
#### 分段插值
*龙格（Runge）现象*：
	一些情况下插值点取的越多，近似越不准确（产生剧烈振荡）。

对给定区间  $[a,b]$  作分割 $a = x_{0}< x_{1}< \dots < x_{n} = b$，在每个小区间 $[x_{i},x_{i + 1}]$ 上作 $f(x)$ 以 $\{x_{i},x_{i + 1}\}$ 为节点的线性插值，记这个插值函数为 $p(x) = p_{i}(x)$，则
$$
p_{i}(x) = \frac{x - x_{i + 1}}{x_{i} - x_{i + 1}} f(x_{i}) + \frac{x - x_{i}}{x_{i + 1} - x_{i}} f(x_{i + 1}), \quad x_{i} \leqslant x \leqslant x_{i + 1}
$$
从几何上看即用线段将每两个相邻节点连接起来近似曲线。

#### 三次样条插值
> 给定区间  $[a, b]$  上  $n + 1$  个节点和这些点上的函数值，若  $S(x)$  满足：
> 	$\{S(x_{i}) = y_{i}, i = 0,1, \dots , n\}$；
> 	$S(x)$  在每个小区间  $[x_{i}, x_{i + 1}]$  上至多是一个三次多项式；
> 	$S(x)$  在  $[a, b]$  上有连续的二阶导数。
> 则称  $S(x)$  为  $f(x)$  关于剖分  $a = x_{0} < x_{1} < \dots < x_{n} = b$  的三次样条插值函数, 称  $\{x_{0}, x_{1}, \dots , x_{n}\}$  为样条节点。

构造 n 个三次多项式共需要 4n 个条件，由定义中的插值条件得到 n+1 个，由
$$
S(x_{i} + 0) = S(x_{i} - 0),\quad 即\quad S_{i}(x_i)=S_{i+1}(x_i)
$$
$$
S^{\prime}(x_{i} + 0) = S^{\prime}(x_{i} - 0)
$$
$$
S^{\prime \prime}(x_{i} + 0) = S^{\prime \prime}(x_{i} - 0),\quad i = 1,\dots ,n - 1
$$
又得到 3n-3 个条件，再引入两个边界条件即可确定函数。

用节点处二阶导数表示样条插值函数时称为 M 关系式，用一阶称为 m 关系式。
##### M 关系式构造方法
$S(x)$  在区间  $[x_{i},x_{i + 1}]$  上的表达式为  $S_{i}(x)$；记 $S^{\prime \prime}(x_{i}) = M_{i}$，$S^{\prime \prime}(x_{i + 1}) = M_{i + 1}$。
1. 用插值点 $\{(x_{i},S^{\prime \prime}(x_{i})),(x_{i + 1},S^{\prime \prime}(x_{i + 1}))\}$ 作线性插值；
$$
S_{i}^{\prime \prime}(x) = \frac{x - x_{i + 1}}{x_{i} - x_{i + 1}} M_{i} + \frac{x - x_{i}}{x_{i + 1} - x_{i}} M_{i + 1},\quad x_{i}\leqslant x\leqslant x_{i + 1}
$$
2. 对  $S^{\prime \prime}(x)$  积分两次,记  $h_{i} = x_{i + 1} - x_{i}$；
$$
\begin{array}{l}{{S(x)=S_{i}(x)=\frac{(x_{i+1}-x)^{3}}{6h_{i}}M_{i}+\frac{(x-x_{i})^{3}}{6h_{i}}M_{i+1}+c x+d}}\\ {{=\frac{(x_{i+1}-x)^{3}}{6h_{i}}M_{i}+\frac{(x-x_{i})^{3}}{6h_{i}}M_{i+1}+C(x_{i+1}-x)+D(x-x_{i})}}\end{array}
$$
3. 将  $S(x_{i}) = y_{i},S(x_{i + 1}) = y_{i + 1}$  代入上式；
$$
C = \frac{y_{i}}{h_{i}} -\frac{h_{i}M_{i}}{6},\quad D = \frac{y_{i + 1}}{h_{i}} -\frac{h_{i}M_{i + 1}}{6}
$$
$$
S(x) = \frac{(x_{i + 1} - x)^{3}M_{i} + (x - x_{i})^{3}M_{i + 1}}{6h_{i}} +\frac{(x_{i + 1} - x)y_{i} + (x - x_{i})y_{i + 1}}{h_{i}} -\frac{h_{i}}{6} [(x_{i + 1} - x)M_{i} + (x - x_{i})M_{i + 1}],\quad x\in [x_{i},x_{i + 1}]
$$
4. 在内节点 $x_{i}$，得到 $S_{i}^{\prime}(x_{i}) = S_{i - 1}^{\prime}(x_{i})$；
$$
f(x_{i},x_{i + 1}) - \frac{h_{i}}{3} M_{i} - \frac{h_{i}}{6} M_{i + 1} = f(x_{i - 1},x_{i}) + \frac{h_{i - 1}}{6} M_{i - 1} + \frac{h_{i - 1}}{3} M_{i}
$$
整理得到
$$
\mu_{i}M_{i - 1} + 2M_{i} + \lambda_{i}M_{i + 1} = d_{i},\quad i = 1,2,\dots ,n - 1 \tag{1.27}
$$
$$
\lambda_{i} = \frac{h_{i}}{h_{i} + h_{i - 1}},\quad \mu_{i} = 1 - \lambda_{i}
$$
$$
d_{i} = \frac{6}{h_{i} + h_{i - 1}}\left(\frac{y_{i + 1} - y_{i}}{h_{i}} -\frac{y_{i} - y_{i - 1}}{h_{i - 1}}\right) = 6f(x_{i - 1},x_{i},x_{i + 1})
$$
式(1.27)称为样条插值的  $M$  关系方程组，解得 $\{M_{i},i = 1,2,\dots ,M_{n - 1}\}$。

下面分三种情况讨论边界条件
1. 给定  $M_{0},M_{n}$  的值,此时  $n - 1$  个方程组有  $n - 1$  个未知量  $\{M_{i},i = 1,2,\dots ,n - 1\}$ .当  $M_{0} = 0,M_{n} = 0$  时,称为自然边界条件；
![[三次样条插值表一.jpg]]
2. 给定  $S^{\prime}(x_{0}) = m_{0},S^{\prime}(x_{n}) = m_{n}$  的值,将  $S^{\prime}(x_{0}) = m_{0},S^{\prime}(x_{n}) = m_{n}$  的值分别代入  $S^{\prime}(x)$  在  $[x_{0},x_{1}],[x_{n - 1},x_{n}]$  中的表达式,得到另外两个方程：
$$
2M_{0} + M_{1} = \frac{6}{h_{0}} [f[x_{0},x_{1}] - m_{0}] = d_{0}
$$
$$
M_{n - 1} + 2M_{n} = \frac{6}{h_{n - 1}} [m_{n} - f[x_{n - 1},x_{n}]] = d_{n}
$$
	则得到共  $n + 1$  个未知量,  $n + 1$  个方程组；
![[三次样条插值表二.jpg]]
3. 被插函数以  $x_{n} - x_{0}$  为基本周期时,即  $f(x_{0}) = f(x_{n})$ ,即
$$
S\left(x_{0}\right) = S\left(x_{n}\right),\quad S^{\prime}\left(x_{0}\right) = S^{\prime}\left(x_{n}\right),\quad S^{\prime \prime}\left(x_{0}\right) = S^{\prime \prime}\left(x_{n}\right)
$$
	即  $m_{0} = m_{n}$ $M_{0} = M_{n}$  将  $S^{\prime}(x_{0}) = S^{\prime}(x_{n})$  加入方程组,此时化为  $n$  个变量,  $n$  个方程的方程组
![[三次样条插值表三.jpg]]



## 数值积分和微分
### 数值积分
用  $I(f)$  表示函数  $f(x)$  精确积分值.用  $I_{n}(f)$  表示近似积分值, $\{x_{i}\}$  称为求积节点,  $\alpha_{i}$  称为求积系数,确定  $I_{n}(f)$  中积分系数  $\alpha_{i}$  的过程就是构造数值积分公式的过程。
$$
I(f) = \int_{a}^{b}f(x)\mathrm{d}x,\quad I_{n}(f) = \sum_{i = 0}^{n}\alpha_{i}f(x_{i})
$$
#### 代数精度
> 记  $[a,b]$  上以  $\{x_{i},i = 0,1,\dots ,n\}$  为积分节点的数值积分公式为
> $$I_{n}(f) = \sum_{i = 0}^{n}\alpha_{i}f(x_{i})$$
> 若  $I_{n}(f)$  满足 $E_{n}(x^{k}) = I(x^{k}) - I_{n}(x^{k}) = 0, \quad k = 0,1,\dots ,m$ 而 $E_{n}(x^{m + 1})\neq 0$ 
> 则称  $I_{n}(f)$  具有  $m$  阶代数精度


#### 插值型数值积分
对给定的被积函数  $f(x)$  在  $[a,b]$  上的点列  $\{(x_{i},f(x_{i})),i = 0,1,\dots ,n\}$  作Langrange插值多项式  $L_{n}(x)$  以  $\int_{a}^{b}L_{n}(x)\mathrm{d}x$  近似  $\int_{a}^{b}f(x)\mathrm{d}x$  即
$$
\int_{a}^{b}f(x)\mathrm{d}x\approx \int_{a}^{b}L_{n}(x)\mathrm{d}x = \int_{a}^{b}\sum_{i = 0}^{n}\ell_{i}(x)f(x_{i})\mathrm{d}x = \sum_{i = 0}^{n}\left[\int_{a}^{b}\ell_{i}(x)\mathrm{d}x\right]f(x_{i})
$$
记  $\alpha_{i} = \int_{a}^{b}\ell_{i}(x)\mathrm{d}x$  则有
$$
I_{n}(f) = \int_{a}^{b}L_{n}(x)\mathrm{d}x = \sum_{i = 0}^{n}\alpha_{i}f(x_{i})
$$

#### 牛顿－科特斯（Newton-Cotes）数值积分
插值求积公式中，当所取节点是等距时称为牛顿－科特斯公式。

$n$  等分区间  $[a, b]$ ,取等分点为积分节点  $\{x_{i} = a + i h, i = 0,1,\dots ,n\}$ ,其中  $h = \frac{b - a}{n}$ . 以  $\{(x_{i}, f(x_{i})), i = 1,2,\dots ,n\}$  为插值节点构造插值函数  $L_{n}(x)$
$$
\int_{a}^{b}L_{n}(x)\mathrm{d}x = \sum_{i = 0}^{n}\left(\int_{a}^{b}l_{i}(x)\mathrm{d}x\right)f(x_{i}) = \sum_{i = 0}^{n}\alpha_{i}f(x_{i})
$$
其中
$$
\alpha_{i} = \int_{a}^{b}\ell_{i}(x)\mathrm{d}x = \int_{a}^{b}\frac{(x - x_{0})(x - x_{1})\cdots(x - x_{i - 1})(x - x_{i + 1})\cdots(x - x_{n})}{(x_{i} - x_{0})(x_{i} - x_{1})\cdots(x_{i} - x_{i - 1})(x_{i} - x_{i + 1})\cdots(x_{i} - x_{n})}\mathrm{d}x
$$
令  $x = a + t h, x_{i} = a + i h,$  代入  $\alpha_{i}$  得
$$
\begin{array}{l}{\alpha_{i} = \int_{0}^{n}\frac{t(t - 1)\cdots(t - i + 1)(t - i - 1)\cdots(t - n)}{i!(n - i)!(-1)^{n - i}} h\mathrm{d}t}\\ {= \frac{(b - a)}{n}\frac{(-1)^{n - i}}{i!(n - 1)!}\int_{0}^{n}t(t - 1)\cdots(t - i + 1)(t - i - 1)\cdots(t - n)\mathrm{d}t}\\ {= (b - a)c_{i}^{(n)}} \end{array}
$$
$$
c_{i}^{(n)} = \frac{(-1)^{n - i}}{i!(n - i)!} n\int_{0}^{n}t(t - 1)\dots (t - i + 1)(t - i - 1)\dots (t - n)\mathrm{d}t
$$
称  $c_{i}^{(n)}$  为 Newton- Cotes 积分系数。可见在取等距节点时,积分系数  $c_{i}^{(n)}$  与积分节点和积分区间无直接关系，只与插值的节点总数有关。在上式中取  $n = 1$ ,即为梯形积分系数；取  $n = 2$ ,即为 Simpson 积分系数。


### 复合（复化）数值积分
#### 复合梯形公式
对  $[a,b]$  作等距分割,  $h = \frac{b - a}{n}$ ,  $\{x_{i} = a + ih, i = 0,1,\dots ,n\}$
$$
I(f) = \int_{a}^{b}f(x)\mathrm{d}x = \sum_{i = 0}^{n - 1}\int_{x_{i}}^{x_{i + 1}}f(x)\mathrm{d}x    =\sum_{i=0}^{n-1}\left\{\frac{h}{2}[f(x_{i})+f(x_{i+1})]-f^{\prime\prime}(\xi_{i})\frac{h^{3}}{12}\right\}{\quad=h\left[\frac{1}{2}f(a)+\sum_{i=1}^{n-1}f(x_{i})+\frac{1}{2}f(b)\right]-\sum_{i=0}^{n-1}f^{\prime\prime}(\xi_{i})\frac{h^{3}}{12}}
$$
记  $n$  等分的复化梯形公式为  $T_{n}(f)$  或  $T(h)$ ,有
$$
T(h) = T_{n}(f) = h\left[\frac{1}{2} f(a) + \sum_{i = 1}^{n - 1}f(a + ih) + \frac{1}{2} f(b)\right]
$$
复化梯形公式误差的截断误差按照  $h^{2}$  或说  $\frac{1}{n^{2}}$  的下降速度下降
$$
E_{n}(f) = I(f) - T_{n}(f) = - \frac{h^{3}}{12}\sum_{i = 0}^{n - 1}f^{\prime \prime}(\xi_{i})= -\frac{n h^{3}}{12} f^{\prime \prime}(\xi) = -\frac{h^{2}}{12} (b - a)f^{\prime \prime}(\xi) = -\frac{(b - a)^{3}}{12n^{2}} f^{\prime \prime}(\xi),\quad a\leqslant \xi \leqslant b
$$

#### 复合辛普森公式
记子区间 $[x_k,x_{k+1}]$ 的中点为 $x_{k+\frac{1}{2}}=x_k+\frac{1}{2}h$，则
$$
S_{n}(f) = \frac{h}{6}\left[f(a) + 4\sum_{k = 0}^{n - 1}f(x_{k+\frac{1}{2}}) + 2\sum_{k = 1}^{n - 1}f(x_{k}) + f(b)\right]
$$
误差：
$$
\begin{array}{l}{{I(f)-S_{n}(f)=-\frac{(2h)^{5}}{2880}\sum_{i=0}^{m-1}f^{(4)}(\xi_{i})=-\frac{(2h)^{5}m}{2880}f^{(4)}(\xi)}}\\ {{\qquad=\frac{-(b-a)^{5}}{2880m^{4}}f^{(4)}(\xi)=\frac{-(b-a)^{5}}{180n^{4}}f^{(4)}(\xi),\quad a\leqslant\xi\leqslant b}}\end{array}
$$

#### 变步长复合梯形公式
将子区间  再二等分，取其中点  作新节点，此时区间数增加了一倍为 ，对某个子区间  利用复合梯形公式计算其积分近似值。
$$
\frac{h}{4}[f(x_k)+2f(x_{k+\frac{1}{2}})+f(x_{k+1})]
$$
对整个区间 $[a,b]$ 有
$$
T_{2n}=\sum^{n-1}_{k=0}\frac{h}{4}[f(x_k)+2f(x_{k+\frac{1}{2}})+f(x_{k+1})]=\frac{h}{4}\sum_{k=0}^{n-1}[f(x_k)+f(x_{k+1})]+\frac{h}{2}\sum_{k=0}^{n-1}f(x_{k+\frac{1}{2}})=\frac{h_{n}}{2}\left[\frac{1}{2}f(a)+\sum_{i=1}^{n-1}f(x_{i})+\frac{1}{2}f(b)\right]+\frac{h_{n}}{2}\sum_{i=0}^{n-1}f(x_{i+1/2})
$$
$$
T_{2n}(f) = \frac{1}{2} [T_{n}(f) + H_{n}(f)],\quad H_{n}(f) = h_{n}\sum_{i = 0}^{n - 1}f(x_{i + \frac{1}{2}})
$$

$T_{n}(f)$  的误差大约是  $T_{2n}(f)$  误差的 4 倍。

#### 龙贝格求积公式（逐次分半加速法）
将  $T_{n},S_{n},C_{n},R_{n},\dots$  统一用  $R_{k,j}$  表示,列标  $j = 1,2,\dots$  分别表示梯形、Simpson、Cotes积分,行标  $k$  表示分点数  $n2^{k - 1}$  或步长  $h_{k} = \frac{h}{2^{k - 1}}$。
$$
R_{k,j} = R_{k,j - 1} + \frac{R_{k,j - 1} - R_{k - 1,j - 1}}{4^{j - 1} - 1},\quad k = 2,3,\dots
$$
比如：
$$
S_{n} = \frac{4}{3} T_{2n} - \frac{1}{3} T_{n},\quad C_n=\frac{16}{15}S_{2n}-\frac{1}{15}S_n
$$
$$
R_{n}=\frac{64}{63}C_{2n}-\frac{1}{63}C_n
$$
上式称为龙贝格公式。

## 常微分方程初值问题数值解
讨论如下常微分方程的初值问题
$$
\left\{ \begin{array}{l l}{y^{\prime}(x) = f(x,y),}\\ {y(a) = y_{0},} \end{array} \right.\quad a\leqslant x\leqslant b
$$
### 欧拉公式
#### 通过数值积分得到欧拉公式
对于 $y^{\prime}(x_{n}) = f(x_{n}, y(x_{n}))$，两边积分得到
$$
\int y^{\prime}(x_{n}) = f(x_{n}, y(x_{n}))
$$
#### 基于数值微商的欧拉公式
对求解区间  $[a,b]$  作等距分割的剖分。记步长为  $h = \frac{b - a}{m}$ ,则  $\{x_{n} = a + nh, n = 0,1,\dots ,m\}$ 。
##### 用向前差商近似 $y'(x)$
$y(x)$  的在  $x = x_{n}$  处的一阶向前差商
$$
y^{\prime}(x_{n}) \approx \frac{y(x_{n + 1}) - y(x_{n})}{h}
$$
由微分方程得 $y^{\prime}(x_{n}) = f(x_{n}, y(x_{n}))$，有
$$
f(x_{n}, y(x_{n})) \approx \frac{y(x_{n + 1}) - y(x_{n})}{h}
$$
$$
y(x_{n + 1}) \approx y(x_{n}) + hf(x_{n}, y(x_{n}))
$$
使用  $y_{n}$  近似  $y(x_{n})$ ,得到计算  $y(x_{n + 1})$  近似值  $y_{n + 1}$  的**向前欧拉公式**
$$
y_{n + 1} = y_{n} + hf(x_{n}, y_{n})
$$


#### 基于数值积分的近似公式
梯形公式如下：
$$
y_{n + 1} = y_{n} + \frac{h}{2} (f(x_{n}, y_{n}) + f(x_{n + 1}, y_{n + 1}))
$$
用显式的Euler公式和隐式的梯形公式组成的预估- 校正公式:
$$
\left\{ \begin{array}{l l}{\bar{y}_{n + 1} = y_{n} + h f(x_{n},y_{n}),}\\ {y_{n + 1} = y_{n} + \frac{h}{2}\left[f(x_{n},y_{n}) + f(x_{n + 1},\bar{y}_{n + 1})\right]} \end{array} \right.
$$
即改进的欧拉公式，合并写为
$$
y_{n + 1} = y_{n} + \frac{h}{2} (f(x_{n}, y_{n}) + f(x_{n + 1}, y_{n} + h f(x_{n}, y_{n})))
$$

### 龙格库塔方法
二阶龙格库塔公式：
$$
\left\{ \begin{array}{l l}{y_{n + 1} = y_{n} + h(c_{1}k_{1} + c_{2}k_{2})}\\ {k_{1} = f(x_{n},y_{n})}\\ {k_{2} = f(x_{n} + a h,y_{n} + b h k_{1})} \end{array} \right.
$$
三阶龙格库塔公式：
$$
\left\{ \begin{array}{l l}{y_{n + 1} = y_{n} + \frac{h}{6} (k_{1} + 4k_{2} + k_{3})}\\ {k_{1} = f(x_{n},y_{n})}\\ {k_{2} = f\left(x_{n} + \frac{1}{2} h,y_{n} + \frac{1}{2} h k_{1}\right)}\\ {k_{3} = f(x_{n} + h,y_{n} - h k_{1} + 2h k_{2})}\end{array} \right. $$
$$\left\{\begin{array}{l l}{y_{n + 1} = y_{n} + \frac{h}{4} (k_{1} + 3k_{3})}\\ {k_{1} = f(x_{n},y_{n})}\\ {k_{2} = f\left(x_{n} + \frac{1}{3} h,y_{n} + \frac{1}{3} h k_{1}\right)}\\ {k_{3} = f\left(x_{n} + \frac{2}{3} h,y_{n} + \frac{2}{3} h k_{2}\right)}\end{array} \right. $$
$$\left\{\begin{array}{l l}{y_{n + 1} = y_{n} + \frac{h}{9} (2k_{1} + 3k_{2} + 4k_{3})}\\ {k_{1} = f(x_{n},y_{n})}\\ {k_{2} = f\left(x_{n} + \frac{1}{2} h,y_{n} + \frac{1}{2} h k_{1}\right)}\\ {k_{3} = f\left(x_{n} + \frac{3}{4} h,y_{n} + \frac{3}{4} h k_{2}\right)} \end{array} \right.
$$
四阶龙格库塔公式：
$$
\left\{ \begin{array}{l l}{y_{n + 1} = y_{n} + \frac{h}{6} (k_{1} + 2k_{2} + 2k_{3} + k_{4})}\\ {k_{1} = f(x_{n},y_{n})}\\ {k_{2} = f\left(x_{n} + \frac{1}{2} h,y_{n} + \frac{1}{2} h k_{1}\right)}\\ {k_{3} = f\left(x_{n} + \frac{1}{2} h,y_{n} + \frac{1}{2} h k_{2}\right)}\\ {k_{4} = f(x_{n} + h,y_{n} + h k_{3})} \end{array} \right.
$$
$$
\left\{ \begin{array}{l l}{y_{n + 1} = y_{n} + \frac{h}{8} (k_{1} + 3k_{2} + 3k_{3} + k_{4})}\\ {k_{1} = f(x_{n},y_{n})}\\ {k_{2} = f\left(x_{n} + \frac{1}{3} h,y_{n} + \frac{1}{3} h k_{1}\right)}\\ {k_{3} = f\left(x_{n} + \frac{2}{3} h,y_{n} + \frac{1}{3} h k_{1} + h k_{2}\right)}\\ {k_{4} = f(x_{n} + h,y_{n} + h k_{1} - h k_{2} + h k_{3})} \end{array} \right.
$$


## 非线性方程求解
### 迭代法
#### 二分法
理论基础：介值定理
	设函数  $f(x)$  在  $[a,b]$  上连续,且  $f(a)f(b)< 0$  则  $f(x)$  在  $[a,b]$  上至少有一个零点。

#### 不动点迭代
对给定的方程 $f(x) = 0$，将它转换成等价形式：$x = \phi (x)$，给定初值 $x_{0}$，由此来构造迭代序列  $x_{k + 1} = \phi (x_{k})$ $k = 1,2,\dots$  如果  $\phi (x)$  连续且迭代收敛，
$$
\lim_{k\to \infty}x_{k + 1} = \lim_{k\to \infty}\phi (x_{k}) = \alpha
$$
则有  $\alpha = \phi (\alpha)$  而  $\alpha$  就是方程  $f(x) = 0$  的根。

若  $\phi (x)$  定义在  $[a,b]$  上,如果  $\phi (x)$  满足
1. 当  $x\in [a,b]$  时有  $a\leqslant \phi (x)\leqslant b$
2. $\phi (x)$ 在 $[a,b]$ 上可导，并且存在正数 $L< 1$，使对任意的 $x\in [a,b]$，有  $|\phi '(x)|\leqslant L$
则在  $[a,b]$  上有唯一的点  $x^{*}$  满足  $x^{*} = \phi (x^{*})$  ,称  $x^{*}$  为  $\phi (x)$  的不动点,而且迭代格式  $x_{k + 1} = \phi (x_{k})$  对任意的初值  $x_{0}\in [a,b]$  均收敛于  $\phi (x)$  的不动点  $x^{*}$  ,并有误差估计式
$$
|x^{*} - x_{k}|\leqslant \frac{1}{1 - L} |x_{k+1} - x_{k}|
$$
$$
|x^{*} - x_{k}|\leqslant \frac{L^{k}}{1 - L} |x_{1} - x_{0}|
$$
且存在极限
$$
\lim_{k\to\infty}\frac{x^*-x_{k+1}}{x^*-x_k}=g'(x^*)
$$
