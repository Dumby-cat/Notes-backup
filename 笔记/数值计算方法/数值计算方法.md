```insta-toc
---
title:
  name: Table of Contents
  level: 1
  center: false
exclude: ""
style:
  listType: dash
omit: []
levels:
  min: 1
  max: 6
---

# Table of Contents

- 绪论
    - 误差与有效数字
        - 误差和误差限
        - 有效位数
- 插值
    - 拉格朗日 Lagrange 插值
        - 线性插值
        - 抛物插值
        - 拉格朗日插值多项式
        - 插值余项（截断误差）
    - 具有承袭性的插值公式
        - 牛顿插值多项式
        - 差商（均差）性质
        - 艾米尔特（Hermite）插值
    - 三次样条函数
        - 分段插值
        - 三次样条插值
            - M 关系式构造方法
- 数值积分
    - 机械积分
    - 代数精度
```

## 绪论
### 误差与有效数字
#### 误差和误差限
**绝对误差**（简称**误差**）：
	$e = x^{*} - x$，其中 $x^{*}$  是精确值  $x$  的一个近似值。
**误差限**：
	$|e| = |x^{*} - x| \leqslant \epsilon$，正数 $\epsilon$ 称作误差限。
**相对误差**：
	$e_{r} = \frac{e}{x^{*}} = \frac{x^{*} - x}{x^{*}}$ 或 $e_{r} = \frac{e}{x} = \frac{x^{*} - x}{x}$ 为相对误差。
**相对误差限**：
	$e_{r} = \left|\frac{e}{x^{*}}\right| \leqslant \epsilon_{r}$，正数 $\epsilon_{r}$ 称作相对误差限。
误差类型：模型误差、截断误差、舍入误差、观测误差。


#### 有效位数
**定义**：
	当  $x$  的误差限为某一位的半个单位, 则这一位到第一个非零位的位数称为  $x$  的有效位数。
例子：
	对于 $\pi$ ：
	$3.141$ 为三位有效位数；
	$3.1415$ 为四位有效位数；
	$3.14159$ 为六位有效位数。



## 插值
**插值**定义：
	$f(x)$  为定义在区间  $[a,b]$  上的函数， $\{x_{0},x_{1},\dots ,x_{n}\}$ 为 $[a,b]$ 上$n + 1$ 个**互异**点。若有函数 $\phi (x)$，满足 
	$$\phi (x_{i}) = f(x_{i}),\quad i =  0,1,\dots ,n$$
	则称 $\phi (x)$ 为 $f(x)$ 关于节点 $x_{i}$ 的**插值函数**。称点 $x_{i}$ 为**插值节点**；称 $\{(x_{i},f(x_{i})),i = 0,1,\dots ,n\}$ 为**插值型值点**，简称型值点或插值点， $f(x)$ 称为被插函数。


### 拉格朗日 Lagrange 插值
#### 线性插值
即给定两个插值点，过两点作一条直线，这条直线就是过这两点的**一次多项式插值函数**，简称线性插值。

若用两点式表示这条直线，则有

$$
L_{1}(x) = \frac{x - x_{1}}{x_{0} - x_{1}} f(x_{0}) + \frac{x - x_{0}}{x_{1} - x_{0}} f(x_{1})
$$

称这种形式为**拉格朗日插值多项式**，$l_{0}(x) = \frac{x - x_{1}}{x_{0} - x_{1}}$，$l_{1}(x) = \frac{x - x_{0}}{x_{1} - x_{0}}$，称 $l_{0}(x), l_{1}(x)$ 为**插值基函数**。


#### 抛物插值
即给定三个插值点，过三点作一条抛物线，这条抛物线就是过这三点的二次插值。
$$
\begin{array}{c}{{L_{2}(x)=\frac{(x-x_{1})(x-x_{2})}{(x_{0}-x_{1})(x_{0}-x_{2})}f(x_{0})+\frac{(x-x_{0})(x-x_{2})}{(x_{1}-x_{0})(x_{1}-x_{2})}f(x_{1})}}\\ {{+\frac{(x-x_{0})(x-x_{1})}{(x_{2}-x_{0})(x_{2}-x_{1})}f(x_{2})}}\end{array} 
$$

#### 拉格朗日插值多项式
$n+1$ 个插值点构造 $n$ 次代数多项式。
$$
l_{i}(x) = \frac{(x - x_{0})\cdots(x - x_{i - 1})(x - x_{i + 1})\cdots(x - x_{n})}{(x_{i} - x_{0})\cdots(x_{i} - x_{i - 1})(x_{i} - x_{i + 1})\cdots(x_{i} - x_{n})} = \prod_{0\leqslant j\leqslant n\atop j\neq i}\frac{x - x_{j}}{x_{i} - x_{j}}
$$
$$
L_{n}(x) = \sum_{i = 0}^{n}l_{i}(x)f(x_{i})
$$
#### 插值余项（截断误差）
$$
R(x)=f(x)-p(x) = \frac{f^{(n + 1)}(\xi)}{(n + 1)!} (x - x_{0})(x - x_{1})\dots (x - x_{n}), \quad \xi \in [a,b]
$$

若  $\left|f^{(n + 1)}(x)\right| \leqslant M, x \in [a,b]$ , 则  $R_{n}\left(x\right)$  可表示为
$$
|R_{n}\left(x\right)| \leqslant \frac{M}{(n + 1)!} \prod_{i = 0}^{n}\left|x - x_{i}\right|
$$

### 具有承袭性的插值公式
#### 牛顿插值多项式
线性插值公式可以写成如下形式：
$$
p_1(x)=p_0(x)+c_1(x-x_0),\quad c_1=\frac{f(x_1)-f(x_0)}{x_1-x_0}
$$
抛物插值公式可以写成如下形式：
$$
p_2(x)=p_1(x)+c_2(x-x_0)(x-x_1),\quad c_2=\frac{\frac{f(x_2)-f(x_1)}{x_2-x_0}-\frac{f(x_1)-f(x_0)}{x_1-x_0}}{x_2-x_1}
$$


设任何一个不高于n次的多项式，可以表示成函数
$$1, x - x_0, (x - x_0)(x - x_1), \cdots, (x - x_0)(x - x_1)\cdots(x - x_{n-1})$$
的线性组合，也就是说，可以把满足插值条件
$$p(x_i) = y_i \quad (i=0, 1, \cdots, n)$$
的 $n$ 次插值多项式，写成如下形式
$$
a_0 + a_1(x - x_0) + \cdots + a_n(x - x_0)(x - x_1)\cdots(x - x_{n-1})
$$
其中 $a_k(k=0, 1, 2, \cdots, n)$为待定系数，这种形式的插值多项式称为Newton插值多项式。我们把它记为 $N_n(x)$ 即
$$
N_n(x)=a_0 + a_1(x - x_0) + \cdots + a_n(x - x_0)(x - x_1)\cdots(x - x_{n-1})
$$

#### 差商（均差）性质
> 称函数值的差  $f(x_{1}) - f(x_{0})$  与自变量的差  $x_{1} - x_{0}$  之商比值（即函数在 $(x_0,x_1)$ 上的平均变化率）为  $f(x)$  关于点  $\{x_{0},x_{1}\}$  的一阶差商,记为  $f[x_{0},x_{1}]$
$$
f\left[x_{0},x_{1}\right] = \frac{f(x_{1}) - f(x_{0})}{x_{1} - x_{0}}
$$> 而称
$$
f\left[x_{0},x_{1},x_{2}\right] = \frac{f\left[x_{1},x_{2}\right] - f\left[x_{0},x_{1}\right]}{x_{2} - x_{0}}
$$> 为  $f(x)$  关于点  $x_{0},x_{1},x_{2}$  的二阶差商

由上得出 $N_n(x)$ 的各项系数恰好是各阶差商值：
$$
a_n=f[x_0,x_1,\dots,x_n]
$$
$$
N_n(x)=a_0+a_1(x-x_0)+\dots+a_n(x-x_0)(x-x_1)\dots(x-x_{n-1})
$$
$$
R_n(x)=f[x,x_0,x_1,\dots,x_n]\prod^n_{i=0}(x-x_i)
$$
#### 艾米尔特（Hermite）插值
将牛顿插值中的 $a_n=f[x_0,x_1,\dots,x_n]$ 替换成 $\frac{1}{n!}f^{(n)}(x_0)$，其他不变。

例题：给定  $f(-1) = 0,f(1) = 4,f^{\prime}(-1) = 2,f^{\prime}(1) = 0,$  构造Hermite插值多项式。
<table><tr><td>zi</td><td>f(zi)</td><td>f(zi-1,zi)</td><td>f(zi-2,zi-1,zi)</td><td></td></tr><tr><td>-1</td><td>0</td><td></td><td></td><td></td></tr><tr><td>-1</td><td>0</td><td>2</td><td></td><td></td></tr><tr><td>1</td><td>4</td><td>2</td><td>0</td><td></td></tr><tr><td>1</td><td>4</td><td>0</td><td>-1</td><td>-0.5</td></tr></table>
然后得到 $H_{3}(x) = 2(x + 1) - 0.5(x + 1)^{2}(x - 1)$。

更一般的：
给定  $\{x_{0},f(x_{0}),f^{\prime}(x)\} ,\{x_{1},f(x_{1}),f^{\prime}(x_{1})\} ,$  记  $f^{\prime}(x_{0}) = m_{0},f^{\prime}(x_{1})$ $= m_{1}$，得到下列至多3次的Hermite插值多项式
<table><tr><td>xi</td><td>zi</td><td>f(zi)</td><td>f(zi-1,zi)</td><td>f(zi-2,zi-1,zi)</td><td></td></tr><tr><td>x0</td><td>z0</td><td>f(x0)</td><td></td><td></td><td></td></tr><tr><td>x0</td><td>z1</td><td>f(x0)</td><td>m0</td><td></td><td></td></tr><tr><td>x1</td><td>z2</td><td>f(x1)</td><td>f[x0,x1]</td><td>(f[x0,x1] - m0)/(x1 - x0)</td><td></td></tr><tr><td>x1</td><td>z3</td><td>f(x1)</td><td>m1</td><td>(m1 - f[x0,x1]) / (x1 - x0)</td><td>...</td></tr></table>
$$
\begin{array}{c}{{H_{3}(x)=y_{0}+m_{0}(x-x_{0})+\frac{f[x_{0},x_{1}]-m_{0}}{x_{1}-x_{0}}(x-x_{0})^{2}}}\\ {{+\frac{m_{1}-2f[x_{0},x_{1}]+m_{0}}{x_{1}-x_{0}}(x-x_{0})^{2}(x-x_{1})}}\end{array}
$$

### 三次样条函数
#### 分段插值
*龙格（Runge）现象*：
	一些情况下插值点取的越多，近似越不准确（产生剧烈振荡）。

对给定区间  $[a,b]$  作分割 $a = x_{0}< x_{1}< \dots < x_{n} = b$，在每个小区间 $[x_{i},x_{i + 1}]$ 上作 $f(x)$ 以 $\{x_{i},x_{i + 1}\}$ 为节点的线性插值，记这个插值函数为 $p(x) = p_{i}(x)$，则
$$
p_{i}(x) = \frac{x - x_{i + 1}}{x_{i} - x_{i + 1}} f(x_{i}) + \frac{x - x_{i}}{x_{i + 1} - x_{i}} f(x_{i + 1}), \quad x_{i} \leqslant x \leqslant x_{i + 1}
$$
从几何上看即用线段将每两个相邻节点连接起来近似曲线。

#### 三次样条插值
> 给定区间  $[a, b]$  上  $n + 1$  个节点和这些点上的函数值，若  $S(x)$  满足：
> 	$\{S(x_{i}) = y_{i}, i = 0,1, \dots , n\}$；
> 	$S(x)$  在每个小区间  $[x_{i}, x_{i + 1}]$  上至多是一个三次多项式；
> 	$S(x)$  在  $[a, b]$  上有连续的二阶导数。
> 则称  $S(x)$  为  $f(x)$  关于剖分  $a = x_{0} < x_{1} < \dots < x_{n} = b$  的三次样条插值函数, 称  $\{x_{0}, x_{1}, \dots , x_{n}\}$  为样条节点。

构造 n 个三次多项式共需要 4n 个条件，由定义中的插值条件得到 n+1 个，由
$$
S(x_{i} + 0) = S(x_{i} - 0),\quad 即\quad S_{3i}(x_i)=S_{3i+1}(x_i)
$$
$$
S^{\prime}(x_{i} + 0) = S^{\prime}(x_{i} - 0)
$$
$$
S^{\prime \prime}(x_{i} + 0) = S^{\prime \prime}(x_{i} - 0),\quad i = 1,\dots ,n - 1
$$
又得到 3n-3 个条件，再引入两个边界条件即可确定函数。

用节点处二阶导数表示样条插值函数时称为 M 关系式，用一阶称为 m 关系式。
##### M 关系式构造方法
$S(x)$  在区间  $[x_{i},x_{i + 1}]$  上的表达式为  $S_{i}(x)$；记 $S^{\prime \prime}(x_{i}) = M_{i}$，$S^{\prime \prime}(x_{i + 1}) = M_{i + 1}$。
1. 用插值点 $\{(x_{i},S^{\prime \prime}(x_{i})),(x_{i + 1},S^{\prime \prime}(x_{i + 1}))\}$ 作线性插值；
$$
S_{i}^{\prime \prime}(x) = \frac{x - x_{i + 1}}{x_{i} - x_{i + 1}} M_{i} + \frac{x - x_{i}}{x_{i + 1} - x_{i}} M_{i + 1},\quad x_{i}\leqslant x\leqslant x_{i + 1}
$$
2. 对  $S^{\prime \prime}(x)$  积分两次,记  $h_{i} = x_{i + 1} - x_{i}$；



## 数值积分
### 机械积分
### 代数精度
> 记  $[a,b]$  上以  $\{x_{i},i = 0,1,\dots ,n\}$  为积分节点的数值积分公式为
> $$I_{n}(f) = \sum_{i = 0}^{n}\alpha_{i}f(x_{i})$$
> 若  $I_{n}(f)$  满足 $E_{n}(x^{k}) = I(x^{k}) - I_{n}(x^{k}) = 0, \quad k = 0,1,\dots ,m$ 而 $E_{n}(x^{m + 1})\neq 0$ 
> 则称  $I_{n}(f)$  具有  $m$  阶代数精度

